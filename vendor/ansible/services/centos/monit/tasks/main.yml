# @metatitle_es Instalar el paquete monit
# @metatitle_en Install monit package
---

# @comment_es Instalar el paquete #{package>name}
# @comment_en Install #{package>name} package
# @input yum install -y #{package>name}
- name: Install monit
  become: true
  package:
    name: monit
    state: latest

# @comment_es Arrancar monit
# @comment_en Start monit service
# @input systemctl start monit
- name: Enable and start monit
  become: true
  service: name=monit enabled=yes state=started

# @comment_es Copiar la configuraci√≥n de los servicios de monit definidos, ej: sshd, uso de disco
# @comment_en Copy monit services configuration, i.e.: sshd, disk usage
# @input
# # /etc/monit.d/sshd.monit
# f{sshd.monit}
#
# # /etc/monit.d/disk-usage.monit
# f{disk-usage.monit}
- name: Copy the monit service files
  become: true
  copy:
    src: "{{item}}"
    dest: "/etc/monit.d/{{item}}"
  with_items:
    - sshd.monit
    - disk-usage.monit
  notify:
    - Reload Monit

# @comment_es Resetear monit
# @comment_en Reset monit
# @input #{shell}
- name: Reset monit the hard way
  become: true
  shell: "monit quit; sleep 5; monit"
